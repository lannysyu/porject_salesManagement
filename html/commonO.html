<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
</head>
<body>
	<div class="nav-wrap">
		<nav class="main-nav" role="navigation" th:fragment="sidebar">
			<div id="sidenav">
				<div class="wrapper">
					<div class="logo">
						<a class="image-link" style="padding-top: 5px;"
							th:onclick="|changeRightPage(contextPath + '/frontend/frontPage')|">
							<img src="/cki_middle/img/logo.png" style="padding: 5px;"
							width="80%" title="回首頁">
						</a>
					</div>
					<div class="menu menu-wrap">
						<ul>
							<li>
								<p class="func-Menu jq-clickBtn">前台功能</p>
								<ul class="func-List jq-dropdown">
									<li sec:authorize="hasAuthority('queryDuplicatePolicyInfo')">
										<a th:text="${session.userAuths['queryDuplicatePolicyInfo']}"
										th:onclick="|changeRightPage(contextPath + '/frontend/queryDuplicatePolicyInfo')|"></a>
									</li>
									<li sec:authorize="hasAuthority('maintainWhiteList')">
										<a href="#" onclick="changeRightPage('/frontend/maintainWhiteList')">維護白名單</a>
									</li>
									<li sec:authorize="hasAuthority('queryWhiteList')"><a
										th:text="${session.userAuths['queryWhiteList']}"
										th:onclick="|changeRightPage(contextPath + '/frontend/queryWhiteList')|"></a>
									</li>
									<li sec:authorize="hasAuthority('queryIneffStaff')"><a
										th:text="${session.userAuths['queryIneffStaff']}"
										th:onclick="|changeRightPage(contextPath + '/frontend/queryIneffStaff')|"></a>
									</li>
									<li sec:authorize="hasAuthority('maintainIneffStaff')"><a
										th:text="${session.userAuths['maintainIneffStaff']}"
										th:onclick="|changeRightPage(contextPath + '/frontend/maintainIneffStaff')|"></a>
									</li>
									<li sec:authorize="hasAuthority('cancelCustomerDataShare')"><a
										th:text="${session.userAuths['cancelCustomerDataShare']}"
										th:onclick="|changeRightPage(contextPath + '/frontend/cancelCustomerDataShare')|"></a>
									</li>
								</ul>
							</li>
							<li>
								<p class="func-Menu system-clickBtn">後台管理</p>
								<ul class="func-List system-dropdown">
									<li sec:authorize="hasAuthority('noticeManage')"><a
										th:text="${session.userAuths['noticeManage']}"
										th:onclick="|changeRightPage(contextPath + '/systemManage/noticeManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('quartzManage')"><a
										th:text="${session.userAuths['quartzManage']}"
										th:onclick="|changeRightPage(contextPath + '/systemManage/quartzManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('batchView')"><a
										th:text="${session.userAuths['batchView']}"
										th:onclick="|changeRightPage(contextPath + '/systemManage/batchView')|"></a>
									</li>
									<li sec:authorize="hasAuthority('middleConf')"><a
										th:text="${session.userAuths['middleConf']}"
										th:onclick="|changeRightPage(contextPath + '/systemManage/middleConf')|"></a>
									</li>
									<li sec:authorize="hasAuthority('cacheManage')"><a
										th:text="${session.userAuths['cacheManage']}"
										th:onclick="|changeRightPage(contextPath + '/systemManage/cacheManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('druid')"><a
										th:text="${session.userAuths['druid']}"
										th:href="@{'/druid/login.html'}"></a></li>
								</ul>
							</li>
							<li>
								<p class="func-Menu auth-clickBtn">權限管理</p>
								<ul class="func-List auth-dropdown">
									<li sec:authorize="hasAuthority('userManage')"><a
										th:text="${session.userAuths['userManage']}"
										th:onclick="|changeRightPage(contextPath + '/auth/userManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('userRoleManage')"><a
										th:text="${session.userAuths['userRoleManage']}"
										th:onclick="|changeRightPage(contextPath + '/auth/userRoleManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('roleManage')"><a
										th:text="${session.userAuths['roleManage']}"
										th:onclick="|changeRightPage(contextPath + '/auth/roleManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('roleAuthManage')"><a
										th:text="${session.userAuths['roleAuthManage']}"
										th:onclick="|changeRightPage(contextPath + '/auth/roleAuthManage')|"></a>
									</li>
									<li sec:authorize="hasAuthority('authManage')"><a
										th:text="${session.userAuths['authManage']}"
										th:onclick="|changeRightPage(contextPath + '/auth/authManage')|"></a>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<input type="hidden" th:value="${session.userInfo.userId}"
				name="userId" />
		</nav>
		<nav id="page-bar"
			style="background: linear-gradient(to top right, #c5ab77, #846339);"
			th:fragment="page-bar">
			<div class="clearfix">
				<div class="bar-title">
					<span>登入員編：</span> <span
						th:with="userId=${session.userInfo.userId}"
						th:text="${userId.substring(0, 1).equalsIgnoreCase('c') ? userId.substring(1) : userId}"></span>
					&nbsp;
					<form th:action="@{/logout}" method="post">
						<input type="hidden" th:name="${_csrf.parameterName}"
							th:value="${_csrf.token}" />
						<button type="submit" class="logout-button">登出</button>
					</form>
				</div>
			</div>
		</nav>
		<nav id="page-right"
			th:style="${noticeVO != null and noticeVO.noticeEmergencyList != null and not #lists.isEmpty(noticeVO.noticeEmergencyList)} ? 'top: 100px;' : 'top: 50px;'"
			th:fragment="page-right"></nav>
		<!-- 分頁機制 -->
		<div th:fragment="paginationFragment(changePageMethod)">
		    <table style="border: 0;width: 150px;margin-left: auto; margin-right: auto;" th:if="${pageNumArray}">
		        <tr style="border-bottom:0;">
		            <td style="border-top:0;">
		                <a href="#" th:onclick="@{ ${changePageMethod} + '(1, \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }">&lt;&lt;&nbsp;</a>
		                <a href="#" th:onclick="@{ ${changePageMethod} + '(\'up\', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }">&lt;&nbsp;</a> 
		                <!-- 分頁小於20頁 -->
		                <th:block th:if="${#lists.size(pageNumArray)} <= 20">
		                    <span th:each="pageNum : ${pageNumArray}">
		                        <a href="#" th:text="'['+${pageNum}+']'"
		                        th:style="${pageNum == changePageNum ? 'color: red;' : ''}" 
		                        th:onclick="@{ ${changePageMethod} + '(' + ${pageNum} + ', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }"></a>
		                    </span>
		                </th:block>
		                <!-- 分頁大於20頁 -->
		                <th:block th:if="${#lists.size(pageNumArray)} > 20">
		                    <!-- 呈顯前三頁 -->
		                    <th:block th:each="pageNum, stat : ${pageNumArray}" th:if="${stat.index < 3}">
		                        <a href="#" th:text="'['+${pageNum}+']'"
		                        th:style="${pageNum == changePageNum ? 'color: red;' : ''}" 
		                        th:onclick="@{ ${changePageMethod} + '(' + ${pageNum} + ', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }"></a>
		                    </th:block>
		                    ...
		                    <!-- 輸入頁數 -->
		                    <input type="text" style="width: 50px;text-align: center"
		                        th:value="${changePageNum}"
		                        th:onchange="@{ ${changePageMethod} + '(this.value, \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }"
		                        onkeyup="this.value=this.value.replace(/[^\d]/g,'');">
		                    ...
		                    <!-- 呈顯後三頁 -->
		                    <th:block th:each="pageNum, stat : ${pageNumArray}" th:if="${stat.index >= #lists.size(pageNumArray) - 3}">
		                        <a href="#" th:text="'['+${pageNum}+']'"
		                        th:style="${pageNum == changePageNum ? 'color: red;' : ''}" 
		                        th:onclick="@{ ${changePageMethod} + '(' + ${pageNum} + ', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }"></a>
		                    </th:block>
		                </th:block>
		                <a href="#" th:onclick="@{ ${changePageMethod} + '(\'down\', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }">>&nbsp;</a>
		                <a href="#" th:onclick="@{ ${changePageMethod} + '(' + ${endPageNum} + ', \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }">>></a>
		                &nbsp;&nbsp;
		                <select style="width: 60px" th:field="*{pageSize}" th:id="pageSize" th:onchange="@{ ${changePageMethod} + '(1, \'' + *{sortField} + '\', \'' + *{sortDirection} + '\')' }">
		                    <option th:each="entry:${pageSizeMap}"
		                        th:value="${entry.key}" th:text="${entry.value}"></option>
		                </select>
		            </td>
		        </tr>
		    </table>
		</div>
	</div>
</body>
</html>
